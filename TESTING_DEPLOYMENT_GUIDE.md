# ðŸ“‹ æ¸¬è©¦èˆ‡éƒ¨ç½²å®Œæ•´æŒ‡å—

## ç›®éŒ„
1. [å–®æ©Ÿæ¸¬è©¦æµç¨‹](#1-å–®æ©Ÿæ¸¬è©¦æµç¨‹)
2. [Raspberry Pi 5 éƒ¨ç½²æº–å‚™](#2-raspberry-pi-5-éƒ¨ç½²æº–å‚™)
3. [å…©å¼µSDå¡éƒ¨ç½²æ–¹æ¡ˆ](#3-å…©å¼µsdå¡éƒ¨ç½²æ–¹æ¡ˆ)
4. [å®Œæ•´æ¸¬è©¦å ´æ™¯](#4-å®Œæ•´æ¸¬è©¦å ´æ™¯)
5. [æ•…éšœæŽ’é™¤](#5-æ•…éšœæŽ’é™¤)

---

## 1. å–®æ©Ÿæ¸¬è©¦æµç¨‹

### 1.1 ç’°å¢ƒæº–å‚™

#### ç³»çµ±éœ€æ±‚
- Python 3.8+
- ç€è¦½å™¨ï¼ˆChrome/Firefox/Safariï¼‰
- è‡³å°‘ 2GB RAM
- ç£ç¢Ÿç©ºé–“ 500MB+

#### å®‰è£ä¾è³´
```bash
cd /home/user/medical-inventory-system_v1.4.1

# å®‰è£ Python ä¾è³´
pip3 install fastapi uvicorn pydantic qrcode[pil] pillow

# æˆ–ä½¿ç”¨ requirements.txt (å¦‚æžœæœ‰)
# pip3 install -r requirements.txt
```

### 1.2 å•Ÿå‹•å¾Œç«¯æœå‹™

```bash
# å•Ÿå‹• FastAPI å¾Œç«¯
python3 main.py
```

**é æœŸè¼¸å‡ºï¼š**
```
======================================================================
ðŸ¥ é†«ç™‚ç«™åº«å­˜ç®¡ç†ç³»çµ± API v1.4.5
======================================================================
ðŸŒ æœå‹™åœ°å€: http://0.0.0.0:8000
ðŸ“– APIæ–‡ä»¶: http://localhost:8000/docs
ðŸ“Š å¥åº·æª¢æŸ¥: http://localhost:8000/api/health
======================================================================
âœ¨ v1.4.5 æ–°åŠŸèƒ½:
   - UI å…¨é¢é‡æ§‹ï¼ˆHeroicons + æ–°è‰²ç³»ï¼‰
   - è™•ç½®æ¨™ç±¤é æ•´åˆï¼ˆæ‰‹è¡“è¨˜éŒ„ + ä¸€èˆ¬æ¶ˆè€—ï¼‰
   - è¡€åº«ç®¡ç†å¢žå¼·ï¼ˆç—…æ‚£è³‡è¨Š + æ­·å²è¨˜éŒ„ï¼‰
   - è¨­å‚™è‡ªå‹•åˆ·æ–°æ©Ÿåˆ¶ï¼ˆæ¯æ—¥ 07:00amï¼‰
   - éŸ¿æ‡‰å¼è¨­è¨ˆå„ªåŒ–
======================================================================
æŒ‰ Ctrl+C åœæ­¢æœå‹™
======================================================================
INFO:     Started server process [12345]
INFO:     Waiting for application startup.
INFO:     è³‡æ–™åº«åˆå§‹åŒ–: database/medical_inventory.db
INFO:     å·²åˆå§‹åŒ–é è¨­é†«é™¢ HOSP-001 èˆ‡ç«™é»ž TC-01
INFO:     è³‡æ–™åº«åˆå§‹åŒ–å®Œæˆ
INFO:     âœ“ æ¯æ—¥è¨­å‚™é‡ç½®èƒŒæ™¯ä»»å‹™å·²å•Ÿå‹• (07:00am)
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
```

### 1.3 å–®æ©Ÿå¤šç«™é»žæ¸¬è©¦

#### æ–¹æ³•ä¸€ï¼šå¤šç€è¦½å™¨æ¨™ç±¤é æ¨¡æ“¬ï¼ˆæŽ¨è–¦ï¼‰

**åŽŸç†ï¼š** åŒä¸€å€‹å¾Œç«¯ï¼Œå¤šå€‹å‰ç«¯æ¨™ç±¤é ä»£è¡¨ä¸åŒç«™é»ž

**æ­¥é©Ÿï¼š**

1. **å•Ÿå‹•å¾Œç«¯æœå‹™**
   ```bash
   python3 main.py
   ```

2. **é–‹å•Ÿç€è¦½å™¨ï¼Œå‰µå»ºå¤šå€‹æ¨™ç±¤é **
   - æ¨™ç±¤é  1: `http://localhost:8000/` â†’ ä»£è¡¨ç«™é»ž TC-01
   - æ¨™ç±¤é  2: `http://localhost:8000/` â†’ ä»£è¡¨ç«™é»ž TC-02 (éœ€æ‰‹å‹•ä¿®æ”¹ stationId)
   - æ¨™ç±¤é  3: `http://localhost:8000/` â†’ ä»£è¡¨ç«™é»ž TC-03 (éœ€æ‰‹å‹•ä¿®æ”¹ stationId)

3. **åœ¨ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·ä¿®æ”¹ç«™é»žID**
   - æŒ‰ F12 æ‰“é–‹é–‹ç™¼è€…å·¥å…·
   - åˆ‡æ›åˆ° Console æ¨™ç±¤
   - åŸ·è¡Œä»¥ä¸‹ä»£ç¢¼ï¼ˆä»¥æ¨™ç±¤é  2 ç‚ºä¾‹ï¼‰ï¼š
   ```javascript
   // ä¿®æ”¹ç«™é»žIDç‚º TC-02
   localStorage.setItem('stationId', 'TC-02');
   location.reload();
   ```

4. **é©—è­‰ç«™é»žID**
   - æŸ¥çœ‹é é¢å³ä¸Šè§’æ˜¯å¦é¡¯ç¤ºæ­£ç¢ºçš„ç«™é»žID
   - é€²å…¥ã€ŒåŒæ­¥ç®¡ç†ã€æ¨™ç±¤é ï¼Œç¢ºèªç«™é»žè³‡è¨Š

#### æ–¹æ³•äºŒï¼šä¿®æ”¹ Index.htmlï¼ˆæ›´æŒä¹…ï¼‰

1. **è¤‡è£½ Index.html ç‚ºä¸åŒç«™é»žç‰ˆæœ¬**
   ```bash
   cp Index.html Index_TC02.html
   cp Index.html Index_TC03.html
   ```

2. **ä¿®æ”¹ç«™é»žIDï¼ˆä»¥ Index_TC02.html ç‚ºä¾‹ï¼‰**
   ```javascript
   // æ‰¾åˆ°ç¬¬ 2043 è¡Œ
   stationId: 'TC-02',  // åŽŸæœ¬æ˜¯ 'TC-01'
   ```

3. **é–‹å•Ÿä¸åŒçš„HTMLæ–‡ä»¶**
   - `http://localhost:8000/` â†’ TC-01
   - `http://localhost:8000/Index_TC02.html` â†’ TC-02
   - `http://localhost:8000/Index_TC03.html` â†’ TC-03

### 1.4 æ¸¬è©¦æµç¨‹

#### æ¸¬è©¦ 1: åŸºæœ¬åŠŸèƒ½é©—è­‰
```
1. é–‹å•Ÿ http://localhost:8000/
2. æŸ¥çœ‹çµ±è¨ˆè³‡æ–™æ˜¯å¦æ­£ç¢ºé¡¯ç¤º
3. æ¸¬è©¦å„æ¨™ç±¤é åˆ‡æ›ï¼ˆç‰©å“ã€é€²è²¨ã€è™•ç½®ã€è¡€è¢‹ã€è¨­å‚™ã€åŒæ­¥ç®¡ç†ï¼‰
4. æ–°å¢žæ¸¬è©¦ç‰©å“
5. åŸ·è¡Œé€²è²¨æ“ä½œ
6. åŸ·è¡Œæ¶ˆè€—æ“ä½œ
7. æª¢æŸ¥è¡€è¢‹åº«å­˜
```

#### æ¸¬è©¦ 2: åŒæ­¥å°åŒ…ç”¢ç”Ÿ
```
1. é€²å…¥ã€ŒåŒæ­¥ç®¡ç†ã€æ¨™ç±¤é 
2. é¸æ“‡ã€Œå…¨é‡åŒæ­¥ (FULL)ã€
3. é»žæ“Šã€Œç”¢ç”Ÿå°åŒ…ã€
4. æŸ¥çœ‹å°åŒ…è³‡è¨Š:
   - å°åŒ…ID: PKG-YYYYMMDD-HHMMSS-TC-01
   - è®Šæ›´æ•¸: X é …
   - å¤§å°: X KB
   - æ ¡é©—ç¢¼: SHA-256 hash
5. é»žæ“Šã€Œä¸‹è¼‰ JSONã€
6. æª¢æŸ¥ä¸‹è¼‰çš„ JSON æª”æ¡ˆæ ¼å¼
```

#### æ¸¬è©¦ 3: åŒæ­¥å°åŒ…åŒ¯å…¥
```
1. ä½¿ç”¨å¦ä¸€å€‹æ¨™ç±¤é ï¼ˆä»£è¡¨ TC-02ï¼‰
2. ä¸Šå‚³å‰›æ‰ä¸‹è¼‰çš„ JSON å°åŒ…
3. é»žæ“Šã€ŒåŒ¯å…¥å°åŒ…ã€
4. æŸ¥çœ‹åŒ¯å…¥çµæžœ:
   - âœ“ åŒ¯å…¥æˆåŠŸ
   - å¥—ç”¨è®Šæ›´: X é …
   - è¡çª: 0 é …
5. æª¢æŸ¥ç‰©å“åˆ—è¡¨æ˜¯å¦åŒæ­¥
6. æª¢æŸ¥è¡€è¢‹åº«å­˜æ˜¯å¦åŒæ­¥
```

#### æ¸¬è©¦ 4: å¢žé‡åŒæ­¥æ¸¬è©¦
```
1. åœ¨ TC-01 æ–°å¢žä¸€ç­†é€²è²¨è¨˜éŒ„
2. è¨˜éŒ„ç•¶å‰æ™‚é–“
3. é€²å…¥ã€ŒåŒæ­¥ç®¡ç†ã€
4. é¸æ“‡ã€Œå¢žé‡åŒæ­¥ (DELTA)ã€
5. è¨­å®šèµ·å§‹æ™‚é–“ç‚ºå‰›æ‰è¨˜éŒ„çš„æ™‚é–“
6. ç”¢ç”Ÿå°åŒ…ï¼ˆæ‡‰è©²åªåŒ…å«æ–°å¢žçš„é‚£ç­†è¨˜éŒ„ï¼‰
7. é©—è­‰å°åŒ…è®Šæ›´æ•¸ç‚º 1
8. å°‡æ­¤å°åŒ…åŒ¯å…¥åˆ° TC-02
9. ç¢ºèª TC-02 æ”¶åˆ°æ–°çš„é€²è²¨è¨˜éŒ„
```

---

## 2. Raspberry Pi 5 éƒ¨ç½²æº–å‚™

### 2.1 ç¡¬é«”éœ€æ±‚

- **Raspberry Pi 5** (4GB RAM ä»¥ä¸ŠæŽ¨è–¦)
- **SDå¡** å…©å¼µï¼ˆå»ºè­° 32GB Class 10 æˆ– U3 ä»¥ä¸Šï¼‰
- **é›»æºä¾›æ‡‰** (5V/3A USB-C)
- **ç¶²è·¯** (é¸é…ï¼šWiFi æˆ– Ethernet)
- **USBéš¨èº«ç¢Ÿ** (ç”¨æ–¼å¯¦é«”è³‡æ–™è½‰ç§»æ¸¬è©¦)

### 2.2 SDå¡ç‡’éŒ„

#### ä½¿ç”¨ Raspberry Pi Imager

1. **ä¸‹è¼‰ Raspberry Pi Imager**
   - å®˜ç¶²: https://www.raspberrypi.com/software/

2. **ç‡’éŒ„ç¬¬ä¸€å¼µSDå¡ (TC-01 ç«™é»ž)**
   ```
   ä½œæ¥­ç³»çµ±: Raspberry Pi OS (64-bit) Lite
   ä¸»æ©Ÿåç¨±: raspberrypi-tc01
   ä½¿ç”¨è€…åç¨±: pi
   å¯†ç¢¼: [è¨­å®šæ‚¨çš„å¯†ç¢¼]
   WiFi: [é¸é…è¨­å®š]
   ```

3. **ç‡’éŒ„ç¬¬äºŒå¼µSDå¡ (TC-02 ç«™é»ž)**
   ```
   ä½œæ¥­ç³»çµ±: Raspberry Pi OS (64-bit) Lite
   ä¸»æ©Ÿåç¨±: raspberrypi-tc02
   ä½¿ç”¨è€…åç¨±: pi
   å¯†ç¢¼: [è¨­å®šæ‚¨çš„å¯†ç¢¼]
   WiFi: [é¸é…è¨­å®š]
   ```

### 2.3 ç³»çµ±åˆå§‹åŒ–è…³æœ¬

å°‡æ­¤è…³æœ¬ä¿å­˜ç‚º `setup_raspberry.sh`ï¼Œä¸Šå‚³åˆ°å…©å°Raspberry Piï¼š

```bash
#!/bin/bash

echo "========================================="
echo "é†«ç™‚ç«™åº«å­˜ç®¡ç†ç³»çµ± - Raspberry Pi åˆå§‹åŒ–"
echo "========================================="

# æ›´æ–°ç³»çµ±
echo "[1/5] æ›´æ–°ç³»çµ±å¥—ä»¶..."
sudo apt update
sudo apt upgrade -y

# å®‰è£ Python èˆ‡ä¾è³´
echo "[2/5] å®‰è£ Python èˆ‡ä¾è³´..."
sudo apt install -y python3 python3-pip python3-venv git

# å®‰è£ç³»çµ±ä¾è³´ï¼ˆfor PIL/Pillowï¼‰
sudo apt install -y libjpeg-dev zlib1g-dev

# å»ºç«‹æ‡‰ç”¨ç›®éŒ„
echo "[3/5] å»ºç«‹æ‡‰ç”¨ç›®éŒ„..."
mkdir -p ~/medical-inventory
cd ~/medical-inventory

# å®‰è£ Python å¥—ä»¶
echo "[4/5] å®‰è£ Python å¥—ä»¶..."
pip3 install fastapi uvicorn pydantic qrcode[pil] pillow --break-system-packages

# å»ºç«‹æœå‹™å•Ÿå‹•è…³æœ¬
echo "[5/5] å»ºç«‹å•Ÿå‹•è…³æœ¬..."
cat > ~/medical-inventory/start.sh << 'STARTSCRIPT'
#!/bin/bash
cd ~/medical-inventory
python3 main.py
STARTSCRIPT

chmod +x ~/medical-inventory/start.sh

echo "========================================="
echo "âœ“ åˆå§‹åŒ–å®Œæˆï¼"
echo "========================================="
echo "ä¸‹ä¸€æ­¥ï¼š"
echo "1. å°‡å°ˆæ¡ˆæª”æ¡ˆä¸Šå‚³åˆ° ~/medical-inventory/"
echo "2. åŸ·è¡Œ: ./start.sh"
echo "========================================="
```

**åŸ·è¡Œåˆå§‹åŒ–ï¼š**
```bash
# ä¸Šå‚³è…³æœ¬åˆ° Raspberry Pi
scp setup_raspberry.sh pi@raspberrypi-tc01.local:~/

# SSH é€£æŽ¥åˆ° Raspberry Pi
ssh pi@raspberrypi-tc01.local

# åŸ·è¡Œåˆå§‹åŒ–
chmod +x setup_raspberry.sh
./setup_raspberry.sh
```

---

## 3. å…©å¼µSDå¡éƒ¨ç½²æ–¹æ¡ˆ

### 3.1 æ–¹æ¡ˆæ¦‚è¿°

**ç›®æ¨™ï¼š** ä½¿ç”¨å…©å¼µSDå¡æ¨¡æ“¬å…©å€‹ç¨ç«‹é†«ç™‚ç«™ï¼Œæ¸¬è©¦å®Œæ•´çš„åŒæ­¥æµç¨‹

**æž¶æ§‹ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Raspberry Pi #1    â”‚         â”‚  Raspberry Pi #2    â”‚
â”‚  SDå¡ A (TC-01)     â”‚         â”‚  SDå¡ B (TC-02)     â”‚
â”‚  IP: 192.168.1.101  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  IP: 192.168.1.102  â”‚
â”‚  ç«¯å£: 8000         â”‚  USB    â”‚  ç«¯å£: 8000         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  åŒæ­¥   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 éƒ¨ç½²æ­¥é©Ÿ

#### Step 1: ä¸Šå‚³å°ˆæ¡ˆåˆ°å…©å° Pi

```bash
# ä¸Šå‚³åˆ° TC-01
scp -r /home/user/medical-inventory-system_v1.4.1/* pi@raspberrypi-tc01.local:~/medical-inventory/

# ä¸Šå‚³åˆ° TC-02
scp -r /home/user/medical-inventory-system_v1.4.1/* pi@raspberrypi-tc02.local:~/medical-inventory/
```

#### Step 2: ä¿®æ”¹ç«™é»žé…ç½®

**TC-01 (ä¸éœ€ä¿®æ”¹ï¼Œé è¨­å°±æ˜¯ TC-01)**

**TC-02 (éœ€è¦ä¿®æ”¹ç«™é»žID):**
```bash
ssh pi@raspberrypi-tc02.local

# ä¿®æ”¹ Index.html
cd ~/medical-inventory
nano Index.html

# æ‰¾åˆ°ç¬¬ 2043 è¡Œï¼Œä¿®æ”¹ç‚º:
stationId: 'TC-02',

# å„²å­˜ä¸¦é€€å‡º (Ctrl+X, Y, Enter)
```

#### Step 3: å•Ÿå‹•æœå‹™

```bash
# TC-01
ssh pi@raspberrypi-tc01.local
cd ~/medical-inventory
./start.sh

# TC-02 (å¦ä¸€å€‹çµ‚ç«¯)
ssh pi@raspberrypi-tc02.local
cd ~/medical-inventory
./start.sh
```

#### Step 4: é©—è­‰æœå‹™

**TC-01:**
```bash
# å¾žç€è¦½å™¨è¨ªå•
http://192.168.1.101:8000/

# æˆ–å¾žå‘½ä»¤åˆ—æ¸¬è©¦
curl http://192.168.1.101:8000/api/health
```

**TC-02:**
```bash
# å¾žç€è¦½å™¨è¨ªå•
http://192.168.1.102:8000/

# æˆ–å¾žå‘½ä»¤åˆ—æ¸¬è©¦
curl http://192.168.1.102:8000/api/health
```

### 3.3 USB å¯¦é«”åŒæ­¥æ¸¬è©¦

#### æº–å‚™ USB éš¨èº«ç¢Ÿ
```bash
# åœ¨ Linux/Mac æ ¼å¼åŒ–ç‚º FAT32
sudo mkfs.vfat -F 32 /dev/sdX1

# æŽ›è¼‰ USB
sudo mkdir -p /mnt/usb
sudo mount /dev/sdX1 /mnt/usb
```

#### åŸ·è¡Œå¯¦é«”åŒæ­¥æµç¨‹

**å ´æ™¯ï¼šTC-01 ç”¢ç”Ÿå°åŒ… â†’ USB â†’ TC-02 åŒ¯å…¥**

1. **TC-01 ç”¢ç”Ÿå°åŒ…**
   ```bash
   # é€éŽç€è¦½å™¨
   http://192.168.1.101:8000/
   â†’ é€²å…¥ã€ŒåŒæ­¥ç®¡ç†ã€
   â†’ é¸æ“‡ã€Œå…¨é‡åŒæ­¥ã€
   â†’ é»žæ“Šã€Œç”¢ç”Ÿå°åŒ…ã€
   â†’ é»žæ“Šã€Œä¸‹è¼‰ JSONã€
   â†’ å°‡æª”æ¡ˆä¿å­˜åˆ° USB
   ```

2. **USB ç‰©ç†ç§»å‹•**
   ```
   TC-01 â†’ æ‹”é™¤ USB â†’ æ’å…¥ TC-02
   ```

3. **TC-02 åŒ¯å…¥å°åŒ…**
   ```bash
   # é€éŽç€è¦½å™¨
   http://192.168.1.102:8000/
   â†’ é€²å…¥ã€ŒåŒæ­¥ç®¡ç†ã€
   â†’ é»žæ“Šã€Œé¸æ“‡åŒæ­¥å°åŒ…æª”æ¡ˆã€
   â†’ é¸æ“‡ USB ä¸­çš„ JSON æª”æ¡ˆ
   â†’ é»žæ“Šã€ŒåŒ¯å…¥å°åŒ…ã€
   â†’ ç¢ºèªåŒ¯å…¥æˆåŠŸ
   ```

---

## 4. å®Œæ•´æ¸¬è©¦å ´æ™¯

### å ´æ™¯ A: é™¢å…§å°ç«™è«‹æ±‚å¤§ç«™æ”¯æ´ï¼ˆç„¡ç¶²è·¯ï¼ŒUSBè½‰ç§»ï¼‰

**åˆå§‹ç‹€æ…‹ï¼š**
- TC-01 (å¤§ç«™): å¤–ç§‘ç¸«åˆé‡ 100 æ”¯
- TC-02 (å°ç«™): å¤–ç§‘ç¸«åˆé‡ 5 æ”¯

**æ¸¬è©¦æµç¨‹ï¼š**

1. **TC-02 è¨˜éŒ„ç·Šæ€¥æ¶ˆè€—**
   ```
   é€²å…¥ã€Œè™•ç½®ã€æ¨™ç±¤
   â†’ æ–°å¢žè™•ç½®è¨˜éŒ„
   â†’ ä½¿ç”¨ 5 æ”¯å¤–ç§‘ç¸«åˆé‡
   â†’ ç¢ºèªæäº¤
   â†’ åº«å­˜æ­¸é›¶
   ```

2. **TC-02 ç”¢ç”ŸåŒæ­¥å°åŒ…**
   ```
   é€²å…¥ã€ŒåŒæ­¥ç®¡ç†ã€
   â†’ é¸æ“‡ã€Œå…¨é‡åŒæ­¥ã€
   â†’ ç”¢ç”Ÿå°åŒ…
   â†’ ä¸‹è¼‰ JSON (å„²å­˜ç‚º PKG-TC02-001.json)
   â†’ è¤‡è£½åˆ° USB
   ```

3. **USB é€è‡³é†«é™¢è¡Œæ”¿å–®ä½**
   ```
   æ¨¡æ“¬ï¼šUSB æ’å…¥é‹è¡Œè°·ç›ºå…¬å¸ç®¡ç†ä»‹é¢çš„é›»è…¦
   ï¼ˆå–®æ©Ÿæ¸¬è©¦æ™‚ï¼Œå¯ç”¨å¦ä¸€å€‹ç€è¦½å™¨æ¨™ç±¤é æ¨¡æ“¬ï¼‰
   ```

4. **é†«é™¢ç³»çµ±ç™¼ç¾ TC-02 çŸ­ç¼º**
   ```
   æŸ¥çœ‹å½™ç¸½å ±å‘Š
   â†’ ç™¼ç¾ TC-02 ç¸«åˆé‡åº«å­˜ç‚º 0
   â†’ æ±ºå®šå¾ž TC-01 èª¿æ’¥ 20 æ”¯
   ```

5. **é†«é™¢å”èª¿èª¿æ’¥**
   ```
   å¯é€éŽ API æˆ–æœªä¾†çš„é†«é™¢ç®¡ç†ä»‹é¢
   POST /api/hospital/transfer/coordinate
   {
     "hospitalId": "HOSP-001",
     "fromStationId": "TC-01",
     "toStationId": "TC-02",
     "resourceType": "ITEM",
     "resourceId": "SURG-001",
     "resourceName": "å¤–ç§‘ç¸«åˆé‡",
     "quantity": 20,
     "operator": "ç‰©è³‡ç®¡ç†å“¡",
     "reason": "TC-02 ç·Šæ€¥çŸ­ç¼º"
   }
   ```

6. **ç”¢ç”Ÿå›žå‚³å°åŒ…çµ¦ TC-02**
   ```
   é†«é™¢ç³»çµ±ç”¢ç”ŸåŒ…å«èª¿æ’¥è¨˜éŒ„çš„å°åŒ…
   â†’ ä¸‹è¼‰ PKG-RESPONSE-TC02-001.json
   â†’ è¤‡è£½åˆ° USB
   ```

7. **USB é€å›ž TC-02**
   ```
   TC-02 åŒ¯å…¥ PKG-RESPONSE-TC02-001.json
   â†’ åŒ¯å…¥æˆåŠŸ
   â†’ åº«å­˜æ›´æ–°ç‚º 20 æ”¯
   ```

**é©—è­‰ï¼š**
- âœ“ TC-02 åº«å­˜æ›´æ–°æ­£ç¢º (20æ”¯)
- âœ“ TC-01 åº«å­˜æ‰£é™¤æ­£ç¢º (80æ”¯)
- âœ“ èª¿æ’¥è¨˜éŒ„å®Œæ•´
- âœ“ äº‹ä»¶æ—¥èªŒé›™å‘è¨˜éŒ„

### å ´æ™¯ B: è·¨é™¢ç·Šæ€¥è¡€è¢‹æ”¯æ´ï¼ˆæœ‰ç¶²è·¯ï¼‰

**åˆå§‹ç‹€æ…‹ï¼š**
- HOSP-001 TC-01: O+ è¡€è¢‹ 10 U
- HOSP-002 TC-01: O+ è¡€è¢‹ 150 U

**æ¸¬è©¦æµç¨‹ï¼š**

1. **HOSP-001 ç™¼ç”Ÿå¤§é‡å‚·æ‚£**
   ```
   TC-01 æ¶ˆè€— 10U O+ è¡€è¢‹
   â†’ è¡€è¢‹åº«å­˜è€—ç›¡
   â†’ è§¸ç™¼çŸ­ç¼ºè­¦å ±
   ```

2. **æäº¤è·¨é™¢è«‹æ±‚ï¼ˆæœªä¾†åŠŸèƒ½ï¼‰**
   ```
   POST /api/central/transfer-request
   {
     "from_hospital_id": "HOSP-002",
     "to_hospital_id": "HOSP-001",
     "resource_type": "BLOOD",
     "blood_type": "O+",
     "quantity_requested": 50,
     "urgency": "CRITICAL",
     "reason": "å¤§é‡å‡ºè¡€å‚·æ‚£ï¼Œè¡€è¢‹è€—ç›¡"
   }
   ```

3. **ä¸­å¤®å¯©æ‰¹ï¼ˆæœªä¾†åŠŸèƒ½ï¼‰**
   ```
   ä¸­å¤®ç³»çµ±è‡ªå‹•å¯©æ‰¹ (urgency=CRITICAL)
   â†’ é€šçŸ¥ HOSP-002
   ```

4. **å¯¦é«”é‹é€è¡€è¢‹**
   ```
   è»äº‹è»ŠéšŠ/ç›´å‡æ©Ÿé‹é€
   ```

5. **é›™æ–¹ç¢ºèªæ”¶ç™¼**
   ```
   HOSP-002 ç¢ºèªç™¼å‡º
   HOSP-001 ç¢ºèªæ”¶åˆ°
   â†’ å…¥åº« 50U O+ è¡€è¢‹
   ```

**é©—è­‰ï¼š**
- âœ“ è·¨é™¢è«‹æ±‚è¨˜éŒ„å®Œæ•´
- âœ“ å¯©æ‰¹æµç¨‹æ­£ç¢º
- âœ“ é›™æ–¹åº«å­˜è®Šæ›´æ­£ç¢º
- âœ“ äº‹ä»¶æ™‚é–“è»¸å®Œæ•´

### å ´æ™¯ C: å¢žé‡åŒæ­¥æ€§èƒ½æ¸¬è©¦

**ç›®æ¨™ï¼š** æ¸¬è©¦å¢žé‡åŒæ­¥çš„æ•ˆçŽ‡

**æµç¨‹ï¼š**

1. **å»ºç«‹åŸºæº–ï¼ˆå…¨é‡åŒæ­¥ï¼‰**
   ```
   TC-01 ç”¢ç”Ÿå…¨é‡åŒæ­¥å°åŒ…
   â†’ è¨˜éŒ„å°åŒ…å¤§å° (ä¾‹: 500 KB, 1000 é …è®Šæ›´)
   ```

2. **åŸ·è¡Œå°‘é‡æ“ä½œ**
   ```
   TC-01 æ–°å¢ž 5 ç­†é€²è²¨è¨˜éŒ„
   è¨˜éŒ„ç•¶å‰æ™‚é–“: 2025-11-12 14:30:00
   ```

3. **ç”¢ç”Ÿå¢žé‡åŒæ­¥å°åŒ…**
   ```
   é¸æ“‡ã€Œå¢žé‡åŒæ­¥ã€
   è¨­å®šèµ·å§‹æ™‚é–“: 2025-11-12 14:30:00
   ç”¢ç”Ÿå°åŒ…
   â†’ è¨˜éŒ„å°åŒ…å¤§å° (ä¾‹: 2 KB, 5 é …è®Šæ›´)
   ```

4. **æ¯”è¼ƒçµæžœ**
   ```
   å…¨é‡åŒæ­¥: 500 KB, 1000 é …
   å¢žé‡åŒæ­¥: 2 KB, 5 é …
   æ•ˆçŽ‡æå‡: 250 å€
   ```

**é©—è­‰ï¼š**
- âœ“ å¢žé‡å°åŒ…åªåŒ…å«æ–°è®Šæ›´
- âœ“ å°åŒ…å¤§å°å¤§å¹…æ¸›å°‘
- âœ“ åŒæ­¥æ™‚é–“ç¸®çŸ­
- âœ“ è³‡æ–™å®Œæ•´æ€§ä¸å—å½±éŸ¿

---

## 5. æ•…éšœæŽ’é™¤

### 5.1 å¸¸è¦‹å•é¡Œ

#### å•é¡Œ 1: ç„¡æ³•å•Ÿå‹•å¾Œç«¯æœå‹™

**éŒ¯èª¤è¨Šæ¯ï¼š**
```
ModuleNotFoundError: No module named 'fastapi'
```

**è§£æ±ºæ–¹æ¡ˆï¼š**
```bash
pip3 install fastapi uvicorn pydantic qrcode[pil] pillow
```

---

#### å•é¡Œ 2: ç€è¦½å™¨ç„¡æ³•é€£æŽ¥

**éŒ¯èª¤è¨Šæ¯ï¼š**
```
ERR_CONNECTION_REFUSED
```

**æª¢æŸ¥æ­¥é©Ÿï¼š**
```bash
# 1. ç¢ºèªæœå‹™æ˜¯å¦é‹è¡Œ
ps aux | grep python

# 2. æª¢æŸ¥ç«¯å£æ˜¯å¦è¢«ä½”ç”¨
netstat -tulpn | grep 8000

# 3. æª¢æŸ¥é˜²ç«ç‰†
sudo ufw status

# 4. æ¸¬è©¦æœ¬åœ°é€£æŽ¥
curl http://localhost:8000/api/health
```

---

#### å•é¡Œ 3: åŒæ­¥å°åŒ…åŒ¯å…¥å¤±æ•—

**éŒ¯èª¤è¨Šæ¯ï¼š**
```
æ ¡é©—ç¢¼ä¸ç¬¦ï¼Œå°åŒ…å¯èƒ½å·²ææ¯€
```

**åŽŸå› ï¼š**
- JSON æª”æ¡ˆåœ¨å‚³è¼¸éŽç¨‹ä¸­ææ¯€
- æª”æ¡ˆç·¨ç¢¼å•é¡Œ

**è§£æ±ºæ–¹æ¡ˆï¼š**
```bash
# 1. æª¢æŸ¥ JSON æª”æ¡ˆæ ¼å¼
cat PKG-xxxxx.json | jq .

# 2. é‡æ–°ä¸‹è¼‰å°åŒ…
```

---

#### å•é¡Œ 4: Raspberry Pi ç¶²è·¯å•é¡Œ

**ç—‡ç‹€ï¼š** ç„¡æ³•è¨ªå• Raspberry Pi

**æª¢æŸ¥æ­¥é©Ÿï¼š**
```bash
# 1. æª¢æŸ¥ IP åœ°å€
hostname -I

# 2. æ¸¬è©¦é€£ç·š
ping raspberrypi-tc01.local

# 3. æª¢æŸ¥ WiFi é€£æŽ¥
iwconfig

# 4. é‡æ–°é…ç½®ç¶²è·¯
sudo raspi-config
â†’ System Options
â†’ Wireless LAN
```

---

#### å•é¡Œ 5: è³‡æ–™åº«åˆå§‹åŒ–å¤±æ•—

**éŒ¯èª¤è¨Šæ¯ï¼š**
```
è³‡æ–™åº«åˆå§‹åŒ–å¤±æ•—: database is locked
```

**è§£æ±ºæ–¹æ¡ˆï¼š**
```bash
# 1. é—œé–‰æ‰€æœ‰ä½¿ç”¨è³‡æ–™åº«çš„ç¨‹åº
pkill -f main.py

# 2. åˆªé™¤è³‡æ–™åº«éŽ–å®šæ–‡ä»¶
rm database/medical_inventory.db-journal

# 3. é‡æ–°å•Ÿå‹•æœå‹™
python3 main.py
```

---

#### å•é¡Œ 6: USB éš¨èº«ç¢ŸæŽ›è¼‰å¤±æ•—

**æª¢æŸ¥æ­¥é©Ÿï¼š**
```bash
# 1. æŸ¥çœ‹ USB è£ç½®
lsblk

# 2. æ‰‹å‹•æŽ›è¼‰
sudo mount /dev/sda1 /mnt/usb

# 3. æª¢æŸ¥æ¬Šé™
ls -la /mnt/usb

# 4. ä¿®æ”¹æ¬Šé™
sudo chmod 777 /mnt/usb
```

---

### 5.2 æ—¥èªŒæŸ¥çœ‹

#### å¾Œç«¯æ—¥èªŒ
```bash
# å³æ™‚æŸ¥çœ‹æ—¥èªŒ
tail -f /var/log/medical-inventory.log

# æœå°‹éŒ¯èª¤
grep ERROR /var/log/medical-inventory.log
```

#### ç€è¦½å™¨æ—¥èªŒ
```
F12 â†’ Console æ¨™ç±¤
æŸ¥çœ‹ JavaScript éŒ¯èª¤èˆ‡ API è«‹æ±‚
```

---

### 5.3 æ•ˆèƒ½å„ªåŒ–

#### Raspberry Pi æ•ˆèƒ½èª¿å„ª
```bash
# å¢žåŠ  swap å¤§å°
sudo dphys-swapfile swapoff
sudo nano /etc/dphys-swapfile
# ä¿®æ”¹ CONF_SWAPSIZE=2048
sudo dphys-swapfile setup
sudo dphys-swapfile swapon

# é—œé–‰ä¸å¿…è¦çš„æœå‹™
sudo systemctl disable bluetooth
sudo systemctl disable hciuart

# è¶…é »ï¼ˆè¬¹æ…Žä½¿ç”¨ï¼‰
sudo nano /boot/config.txt
# æ–°å¢ž:
# over_voltage=6
# arm_freq=2400
```

---

## 6. é€²éšŽé…ç½®

### 6.1 è¨­å®šæœå‹™è‡ªå‹•å•Ÿå‹•

å»ºç«‹ systemd æœå‹™ï¼š

```bash
sudo nano /etc/systemd/system/medical-inventory.service
```

å…§å®¹ï¼š
```ini
[Unit]
Description=Medical Inventory Management System
After=network.target

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi/medical-inventory
ExecStart=/usr/bin/python3 /home/pi/medical-inventory/main.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

å•Ÿç”¨æœå‹™ï¼š
```bash
sudo systemctl daemon-reload
sudo systemctl enable medical-inventory
sudo systemctl start medical-inventory

# æª¢æŸ¥ç‹€æ…‹
sudo systemctl status medical-inventory
```

### 6.2 è¨­å®šå›ºå®š IP

```bash
sudo nano /etc/dhcpcd.conf
```

æ–°å¢žï¼š
```
interface eth0
static ip_address=192.168.1.101/24
static routers=192.168.1.1
static domain_name_servers=192.168.1.1 8.8.8.8
```

é‡å•Ÿç¶²è·¯ï¼š
```bash
sudo systemctl restart dhcpcd
```

---

## 7. å‚™ä»½èˆ‡æ¢å¾©

### 7.1 å‚™ä»½è³‡æ–™åº«

```bash
# è‡ªå‹•å‚™ä»½è…³æœ¬
cat > ~/backup_db.sh << 'BACKUP'
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
cp ~/medical-inventory/database/medical_inventory.db \
   ~/medical-inventory/database/backups/medical_inventory_${DATE}.db
echo "å‚™ä»½å®Œæˆ: medical_inventory_${DATE}.db"
BACKUP

chmod +x ~/backup_db.sh

# è¨­å®šæ¯æ—¥è‡ªå‹•å‚™ä»½
crontab -e
# æ–°å¢ž: æ¯å¤©å‡Œæ™¨ 2 é»žå‚™ä»½
0 2 * * * ~/backup_db.sh
```

### 7.2 æ¢å¾©è³‡æ–™åº«

```bash
# åœæ­¢æœå‹™
sudo systemctl stop medical-inventory

# æ¢å¾©å‚™ä»½
cp ~/medical-inventory/database/backups/medical_inventory_YYYYMMDD_HHMMSS.db \
   ~/medical-inventory/database/medical_inventory.db

# é‡å•Ÿæœå‹™
sudo systemctl start medical-inventory
```

---

## 8. æ¸¬è©¦æª¢æŸ¥æ¸…å–®

### 8.1 å–®æ©Ÿæ¸¬è©¦
- [ ] å¾Œç«¯æœå‹™å•Ÿå‹•æˆåŠŸ
- [ ] å‰ç«¯é é¢è¼‰å…¥æ­£å¸¸
- [ ] æ‰€æœ‰æ¨™ç±¤é åŠŸèƒ½æ­£å¸¸
- [ ] ç‰©å“é€²è²¨/æ¶ˆè€—åŠŸèƒ½æ­£å¸¸
- [ ] è¡€è¢‹æ”¶ç™¼åŠŸèƒ½æ­£å¸¸
- [ ] è¨­å‚™æª¢æŸ¥åŠŸèƒ½æ­£å¸¸
- [ ] æ‰‹è¡“è¨˜éŒ„åŠŸèƒ½æ­£å¸¸
- [ ] åŒæ­¥å°åŒ…ç”¢ç”ŸæˆåŠŸ
- [ ] åŒæ­¥å°åŒ…ä¸‹è¼‰æˆåŠŸ
- [ ] åŒæ­¥å°åŒ…åŒ¯å…¥æˆåŠŸ
- [ ] å¢žé‡åŒæ­¥åŠŸèƒ½æ­£å¸¸

### 8.2 Raspberry Pi éƒ¨ç½²
- [ ] å…©å¼µSDå¡ç³»çµ±å®‰è£å®Œæˆ
- [ ] ä¾è³´å¥—ä»¶å®‰è£æˆåŠŸ
- [ ] å°ˆæ¡ˆæª”æ¡ˆä¸Šå‚³æˆåŠŸ
- [ ] ç«™é»žIDé…ç½®æ­£ç¢º
- [ ] å…©å° Pi æœå‹™å•Ÿå‹•æˆåŠŸ
- [ ] ç¶²è·¯é€£ç·šæ­£å¸¸
- [ ] USB åŒæ­¥æ¸¬è©¦æˆåŠŸ
- [ ] è³‡æ–™å®Œæ•´æ€§é©—è­‰é€šéŽ
- [ ] æ•ˆèƒ½æ¸¬è©¦é€šéŽï¼ˆéŸ¿æ‡‰æ™‚é–“ < 2ç§’ï¼‰
- [ ] è‡ªå‹•å•Ÿå‹•æœå‹™è¨­å®šå®Œæˆ

### 8.3 æ•´åˆæ¸¬è©¦
- [ ] å ´æ™¯Aæ¸¬è©¦é€šéŽï¼ˆUSBå¯¦é«”åŒæ­¥ï¼‰
- [ ] å ´æ™¯Bæ¸¬è©¦é€šéŽï¼ˆè·¨é™¢è«‹æ±‚ï¼‰
- [ ] å ´æ™¯Cæ¸¬è©¦é€šéŽï¼ˆå¢žé‡åŒæ­¥æ•ˆèƒ½ï¼‰
- [ ] è¡çªæª¢æ¸¬åŠŸèƒ½é©—è­‰
- [ ] æ ¡é©—ç¢¼é©—è­‰åŠŸèƒ½æ¸¬è©¦
- [ ] é•·æ™‚é–“ç©©å®šæ€§æ¸¬è©¦ï¼ˆ24å°æ™‚ï¼‰

---

## 9. å¾ŒçºŒæ“´å±•

### 9.1 é†«é™¢å±¤ç®¡ç†ä»‹é¢
- å»ºç«‹ Hospital.htmlï¼ˆè°·ç›ºå…¬å¸ä½¿ç”¨ï¼‰
- å½™ç¸½å¤šç«™é»žè³‡æ–™å„€è¡¨æ¿
- é™¢å…§èª¿æ’¥å”èª¿ä»‹é¢
- å‘ä¸­å¤®ç”¢ç”Ÿæ—¥å ±åŠŸèƒ½

### 9.2 ä¸­å¤®æŒ‡æ®å±¤ä»‹é¢
- å»ºç«‹ Central.html
- å…¨åœ‹è³‡æºåœ°åœ–
- è·¨é™¢è«‹æ±‚å¯©æ‰¹å·¥ä½œæµç¨‹
- æˆ°ç•¥è³‡æºèª¿é…æ±ºç­–æ”¯æ´

### 9.3 é›¢ç·šæ¨¡å¼å„ªåŒ–
- è‡ªå‹•ç¶²è·¯ç‹€æ…‹æª¢æ¸¬
- é›¢ç·šæ“ä½œä½‡åˆ—
- è‡ªå‹•åŒæ­¥æŽ’ç¨‹
- æ–·ç·šæ¢å¾©æ©Ÿåˆ¶

---

## ðŸ“ž æŠ€è¡“æ”¯æ´

å¦‚æœ‰å•é¡Œï¼Œè«‹åƒè€ƒï¼š
- GitHub Issues: https://github.com/anthropics/claude-code/issues
- å°ˆæ¡ˆæ–‡æª”: FEDERATED_ARCHITECTURE.md
- é›¢ç·šåŒæ­¥æ–¹æ¡ˆ: DEPLOYMENT_ARCHITECTURE.md

---

**ç‰ˆæœ¬**: v1.0
**å»ºç«‹æ—¥æœŸ**: 2025-11-12
**é©ç”¨ç‰ˆæœ¬**: medical-inventory-system v1.4.5+
**ä½œè€…**: Claude AI Assistant
