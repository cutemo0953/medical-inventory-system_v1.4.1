<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é†«ç™‚ç«™åº«å­˜ç®¡ç†ç³»çµ± v1.4.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        /* é…è‰²è®Šæ•¸å®šç¾© */
        :root {
            /* ç‰©å“æŸ¥è©¢ - å¤©è—è‰²ç³» */
            --items-primary: #3B82F6;
            --items-hover: #2563EB;
            --items-light: #DBEAFE;

            /* é€²è²¨ - é’ç¶ è‰²ç³» */
            --receive-primary: #0D9488;
            --receive-hover: #0F766E;
            --receive-light: #CCFBF1;

            /* è™•ç½®/æ¶ˆè€— - ç´«è‰²ç³» */
            --disposition-primary: #4E5488;
            --disposition-light: #F3F2F8;
            --disposition-hover: #3D4270;

            /* è¡€åº« - ç´…è‰²ç³» */
            --blood-primary: #D96754;
            --blood-light: #F1AAAB;
            --blood-hover: #C24E3E;

            /* è¨­å‚™ - æ©„æ¬–ç¶ ç³» */
            --equipment-primary: #6C7362;
            --equipment-hover: #555A4D;
            --equipment-light: #E8E9E6;

            /* ç°éšç³»çµ± */
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
        }

        [x-cloak] { display: none !important; }

        /* æ·º teal èƒŒæ™¯æ¼¸è®Š */
        body {
            background: linear-gradient(135deg, #f0f9f8 0%, #e6f7f5 25%, #f5f8ff 50%, #faf5ff 75%, #fff 100%);
            background-attachment: fixed;
        }

        /* è‡ªå®šç¾©æ»¾å‹•æ¢ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* è¡¨æ ¼æ–‘é¦¬ç´‹å„ªåŒ– */
        .table-hover tbody tr:hover {
            background-color: #f0f9ff;
            transition: background-color 0.2s;
        }

        /* ç‰©å“æŸ¥è©¢æŒ‰éˆ•æ¨£å¼ */
        .btn-items-primary {
            background-color: var(--items-primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        .btn-items-primary:hover {
            background-color: var(--items-hover);
        }

        .btn-items-secondary {
            background-color: var(--gray-100);
            color: var(--gray-700);
            border: 1px solid var(--gray-300);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }
        .btn-items-secondary:hover {
            background-color: var(--gray-200);
        }

        .btn-items-action {
            background-color: var(--items-light);
            color: var(--items-primary);
            transition: all 0.2s;
        }
        .btn-items-action:hover {
            background-color: var(--items-primary);
            color: white;
        }

        /* é€²è²¨æŒ‰éˆ•æ¨£å¼ */
        .btn-receive-primary {
            background-color: var(--receive-primary);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        .btn-receive-primary:hover {
            background-color: var(--receive-hover);
        }

        .btn-receive-secondary {
            background-color: var(--gray-100);
            color: var(--gray-700);
            border: 1px solid var(--gray-300);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }
        .btn-receive-secondary:hover {
            background-color: var(--gray-200);
        }

        /* è™•ç½®/æ¶ˆè€—æŒ‰éˆ•æ¨£å¼ */
        .btn-disposition-primary {
            background-color: var(--disposition-primary);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        .btn-disposition-primary:hover {
            background-color: var(--disposition-hover);
        }

        .btn-disposition-secondary {
            background-color: var(--gray-100);
            color: var(--gray-700);
            border: 1px solid var(--gray-300);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }
        .btn-disposition-secondary:hover {
            background-color: var(--gray-200);
        }

        /* è¡€åº«æŒ‰éˆ•æ¨£å¼ */
        .btn-blood-receive {
            background-color: #10B981;
            color: white;
            transition: background-color 0.2s;
        }
        .btn-blood-receive:hover {
            background-color: #059669;
        }

        .btn-blood-consume {
            background-color: var(--blood-primary);
            color: white;
            transition: background-color 0.2s;
        }
        .btn-blood-consume:hover {
            background-color: var(--blood-hover);
        }

        /* è¡€å‹çµ±è¨ˆæ¨£å¼ */
        .blood-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }
        .blood-count {
            font-size: 2rem;
            font-weight: 700;
            color: var(--blood-primary);
        }
        .blood-type {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-700);
            background-color: var(--blood-light);
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
        }

        /* è¨­å‚™æŒ‰éˆ•æ¨£å¼ */
        .btn-equipment-primary {
            background-color: var(--equipment-primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        .btn-equipment-primary:hover {
            background-color: var(--equipment-hover);
        }

        .btn-equipment-secondary {
            background-color: var(--equipment-light);
            color: var(--equipment-primary);
            border: 1px solid var(--equipment-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }
        .btn-equipment-secondary:hover {
            background-color: var(--equipment-primary);
            color: white;
        }

        /* è¨­å‚™ç‹€æ…‹å¾½ç«  */
        .equipment-status {
            font-weight: 600;
            padding: 0.375rem 0.75rem;
            border-radius: 0.5rem;
        }
        .status-equipment-normal {
            background-color: var(--equipment-primary);
            color: white;
        }

        /* çµ±è¨ˆå¡ç‰‡é…è‰² */
        .stat-card {
            border-radius: 0.75rem;
            padding: 1rem;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        .stat-items {
            background-color: var(--items-light);
            border-color: var(--items-primary);
        }
        .stat-warning {
            background-color: #FED7AA;
            border-color: #F59E0B;
        }
        .stat-blood {
            background-color: var(--blood-light);
            border-color: var(--blood-primary);
        }
        .stat-equipment {
            background-color: var(--equipment-light);
            border-color: var(--equipment-primary);
        }
    </style>
</head>
<body class="min-h-screen">
    <div x-data="medicalInventory()" x-init="init()" x-cloak class="max-w-7xl mx-auto p-6">
        
        <!-- Header -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <svg class="w-10 h-10 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                    </svg>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">é†«ç™‚ç«™åº«å­˜ç³»çµ±</h1>
                        <p class="text-sm text-gray-500">v1.4.1 - æ‰‹è¡“è¨˜éŒ„ç‰ˆ</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm text-gray-600">ç«™é»: <span class="font-semibold text-teal-600" x-text="stationId"></span></p>
                    <p class="text-xs text-gray-400" x-text="currentTime"></p>
                </div>
            </div>
        </div>

        <!-- çµ±è¨ˆå¡ç‰‡ -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
            <div class="stat-card stat-items">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm" style="color: var(--gray-600);">ç¸½ç‰©å“æ•¸</p>
                        <p class="text-2xl font-bold" style="color: var(--items-primary);" x-text="stats.totalItems"></p>
                    </div>
                    <div class="p-3 rounded-lg" style="background-color: var(--items-primary);">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="stat-card stat-warning">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-700">åº«å­˜è­¦æˆ’</p>
                        <p class="text-2xl font-bold text-orange-600" x-text="stats.lowStockItems"></p>
                    </div>
                    <div class="p-3 bg-orange-500 rounded-lg">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="stat-card stat-blood">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm" style="color: var(--gray-600);">è¡€è¢‹åº«å­˜</p>
                        <p class="text-2xl font-bold" style="color: var(--blood-primary);"><span x-text="stats.totalBlood"></span> U</p>
                    </div>
                    <div class="p-3 rounded-lg" style="background-color: var(--blood-primary);">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="stat-card stat-equipment">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm" style="color: var(--gray-600);">è¨­å‚™è­¦å ±</p>
                        <p class="text-2xl font-bold" style="color: var(--equipment-primary);" x-text="stats.equipmentAlerts"></p>
                    </div>
                    <div class="p-3 rounded-lg" style="background-color: var(--equipment-primary);">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- åˆ†é é¸å–® -->
        <div class="bg-white rounded-xl shadow mb-6">
            <div class="flex space-x-1 p-2">
                <button @click="switchTab('items')"
                        :class="currentTab === 'items' ? 'bg-teal-50 text-teal-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'"
                        class="flex-1 py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                    </svg>
                    ç‰©å“æŸ¥è©¢
                </button>
                <button @click="switchTab('receive')"
                        :class="currentTab === 'receive' ? 'bg-teal-50 text-teal-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'"
                        class="flex-1 py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                    </svg>
                    é€²è²¨
                </button>
                <button @click="switchTab('consume')"
                        :class="currentTab === 'consume' ? 'bg-teal-50 text-teal-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'"
                        class="flex-1 py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 11l5-5m0 0l5 5m-5-5v12"/>
                    </svg>
                    æ¶ˆè€—
                </button>
                <button @click="switchTab('blood')"
                        :class="currentTab === 'blood' ? 'bg-teal-50 text-teal-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'"
                        class="flex-1 py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                    </svg>
                    è¡€è¢‹
                </button>
                <button @click="switchTab('equipment')"
                        :class="currentTab === 'equipment' ? 'bg-teal-50 text-teal-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'"
                        class="flex-1 py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    è¨­å‚™
                </button>
                <button @click="switchTab('surgery')"
                        :class="currentTab === 'surgery' ? 'bg-teal-50 text-teal-700 font-semibold' : 'text-gray-600 hover:bg-gray-50'"
                        class="flex-1 py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                    </svg>
                    æ‰‹è¡“è¨˜éŒ„
                </button>
            </div>
        </div>

        <!-- ç‰©å“æŸ¥è©¢åˆ†é  -->
        <div x-show="currentTab === 'items'" class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                    </svg>
                    åº«å­˜æŸ¥è©¢
                </h2>
                <div class="flex gap-2">
                    <button @click="showAddItemModal = true" class="btn-items-primary">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                        </svg>
                        æ–°å¢ç‰©å“
                    </button>
                    <button @click="loadItems()" class="btn-items-secondary">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        é‡æ–°è¼‰å…¥
                    </button>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 table-hover">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ä»£ç¢¼</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åç¨±</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åˆ†é¡</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åº«å­˜</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æœ€å°åº«å­˜</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å–®ä½</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <template x-for="item in items" :key="item.code">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900" x-text="item.code"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="item.name"></td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800" x-text="item.category"></span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <span :class="item.current_stock < item.min_stock ? 'text-red-600 font-bold' : 'text-green-600 font-semibold'" 
                                          x-text="item.current_stock"></span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" x-text="item.min_stock"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" x-text="item.unit"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm space-x-2">
                                    <button @click="editItem(item)" class="btn-items-action px-3 py-1 rounded">ç·¨è¼¯</button>
                                    <button @click="deleteItem(item.code, item.name)" class="px-3 py-1 rounded bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600 transition-colors">åˆªé™¤</button>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- é€²è²¨åˆ†é  -->
        <div x-show="currentTab === 'receive'" class="bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                </svg>
                é€²è²¨ç™»è¨˜
            </h2>
            
            <form @submit.prevent="submitReceive()" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç‰©å“ä»£ç¢¼ *</label>
                        <select x-model="receiveForm.itemCode" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                            <option value="">è«‹é¸æ“‡ç‰©å“</option>
                            <template x-for="item in items" :key="item.code">
                                <option :value="item.code" x-text="`${item.code} - ${item.name}`"></option>
                            </template>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡ *</label>
                        <input type="number" x-model="receiveForm.quantity" required min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ‰¹è™Ÿ</label>
                        <input type="text" x-model="receiveForm.batchNumber" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ•ˆæœŸ</label>
                        <input type="date" x-model="receiveForm.expiryDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">å‚™è¨»</label>
                        <textarea x-model="receiveForm.remarks" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"></textarea>
                    </div>
                </div>

                <div class="flex gap-4">
                    <button type="submit" class="btn-receive-primary">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        ç¢ºèªé€²è²¨
                    </button>
                    <button type="button" @click="resetReceiveForm()" class="btn-receive-secondary">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        é‡ç½®
                    </button>
                </div>
            </form>
        </div>

        <!-- æ¶ˆè€—åˆ†é  -->
        <div x-show="currentTab === 'consume'" class="bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 11l5-5m0 0l5 5m-5-5v12"/>
                </svg>
                æ¶ˆè€—ç™»è¨˜
            </h2>
            
            <form @submit.prevent="submitConsume()" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç‰©å“ä»£ç¢¼ *</label>
                        <select x-model="consumeForm.itemCode" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                            <option value="">è«‹é¸æ“‡ç‰©å“</option>
                            <template x-for="item in items" :key="item.code">
                                <option :value="item.code" x-text="`${item.code} - ${item.name} (åº«å­˜: ${item.current_stock})`"></option>
                            </template>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡ *</label>
                        <input type="number" x-model="consumeForm.quantity" required min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç”¨é€”èªªæ˜ *</label>
                        <textarea x-model="consumeForm.purpose" required rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"></textarea>
                    </div>
                </div>

                <div class="flex gap-4">
                    <button type="submit" class="btn-disposition-primary">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        ç¢ºèªæ¶ˆè€—
                    </button>
                    <button type="button" @click="resetConsumeForm()" class="btn-disposition-secondary">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        é‡ç½®
                    </button>
                </div>
            </form>
        </div>

        <!-- è¡€è¢‹åˆ†é  -->
        <div x-show="currentTab === 'blood'" class="bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
                è¡€è¢‹ç®¡ç†
            </h2>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <template x-for="blood in bloodInventory" :key="blood.blood_type">
                    <div class="border-2 border-gray-200 rounded-lg p-4 hover:border-red-300 transition-colors">
                        <div class="blood-stat">
                            <div class="blood-count" x-text="blood.quantity"></div>
                            <div class="blood-type" x-text="blood.blood_type"></div>
                            <div class="text-sm text-gray-500">å–®ä½ (U)</div>
                        </div>
                    </div>
                </template>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- è¡€è¢‹å…¥åº« -->
                <div class="border-2 border-green-200 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-green-700 mb-4">ğŸ“¥ è¡€è¢‹å…¥åº«</h3>
                    <form @submit.prevent="submitBloodReceive()" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">è¡€å‹ *</label>
                            <select x-model="bloodReceiveForm.bloodType" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                                <option value="">è«‹é¸æ“‡è¡€å‹</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡ (U) *</label>
                            <input type="number" x-model="bloodReceiveForm.quantity" required min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                        <button type="submit" class="w-full btn-blood-receive px-4 py-2 rounded-lg">
                            <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                            </svg>
                            ç¢ºèªå…¥åº«
                        </button>
                    </form>
                </div>

                <!-- è¡€è¢‹å‡ºåº« -->
                <div class="border-2 border-red-200 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-red-700 mb-4">ğŸ“¤ è¡€è¢‹å‡ºåº«</h3>
                    <form @submit.prevent="submitBloodConsume()" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">è¡€å‹ *</label>
                            <select x-model="bloodConsumeForm.bloodType" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500">
                                <option value="">è«‹é¸æ“‡è¡€å‹</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡ (U) *</label>
                            <input type="number" x-model="bloodConsumeForm.quantity" required min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500">
                        </div>
                        <button type="submit" class="w-full btn-blood-consume px-4 py-2 rounded-lg">
                            <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                            </svg>
                            ç¢ºèªå‡ºåº«
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- è¨­å‚™åˆ†é  -->
        <div x-show="currentTab === 'equipment'" class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    è¨­å‚™ç®¡ç†
                </h2>
                <div class="flex gap-2">
                    <button @click="showAddEquipmentModal = true" class="btn-equipment-primary">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                        </svg>
                        æ–°å¢è¨­å‚™
                    </button>
                    <button @click="loadEquipment()" class="btn-equipment-secondary">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        é‡æ–°è¼‰å…¥
                    </button>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 table-hover">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">è¨­å‚™ID</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åç¨±</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åˆ†é¡</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ•¸é‡</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ç‹€æ…‹</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">é›»åŠ›</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æœ€å¾Œæª¢æŸ¥</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <template x-for="eq in equipment" :key="eq.id">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900" x-text="eq.id"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="eq.name"></td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600" x-text="eq.category"></span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="eq.quantity"></td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span :class="{
                                        'bg-equipment-primary text-white': eq.status === 'NORMAL',
                                        'bg-yellow-100 text-yellow-800': eq.status === 'WARNING',
                                        'bg-red-100 text-red-800': eq.status === 'ERROR',
                                        'bg-gray-100 text-gray-800': eq.status === 'UNCHECKED'
                                    }" style="background-color: var(--equipment-primary); color: white;" x-show="eq.status === 'NORMAL'" class="px-2 py-1 text-xs font-medium rounded-full" x-text="eq.status"></span>
                                    <span :class="{
                                        'bg-yellow-100 text-yellow-800': eq.status === 'WARNING',
                                        'bg-red-100 text-red-800': eq.status === 'ERROR',
                                        'bg-gray-100 text-gray-800': eq.status === 'UNCHECKED'
                                    }" x-show="eq.status !== 'NORMAL'" class="px-2 py-1 text-xs font-medium rounded-full" x-text="eq.status"></span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                    <span x-show="eq.power_level !== null" x-text="eq.power_level + '%'"></span>
                                    <span x-show="eq.power_level === null" class="text-gray-400">-</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" x-text="eq.last_check ? new Date(eq.last_check).toLocaleString('zh-TW') : '-'"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm space-x-2">
                                    <button @click="checkEquipment(eq)" class="px-3 py-1 rounded" style="background-color: var(--equipment-light); color: var(--equipment-primary);" onmouseover="this.style.backgroundColor='var(--equipment-primary)'; this.style.color='white';" onmouseout="this.style.backgroundColor='var(--equipment-light)'; this.style.color='var(--equipment-primary)';">æª¢æŸ¥</button>
                                    <button @click="editEquipment(eq)" class="px-3 py-1 rounded bg-blue-100 text-blue-600 hover:bg-blue-600 hover:text-white transition-colors">ç·¨è¼¯</button>
                                    <button @click="deleteEquipment(eq.id, eq.name)" class="px-3 py-1 rounded bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600 transition-colors">åˆªé™¤</button>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- æ‰‹è¡“è¨˜éŒ„åˆ†é  -->
        <div x-show="currentTab === 'surgery'" class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                    </svg>
                    æ‰‹è¡“è¨˜éŒ„ç®¡ç†
                </h2>
                <div class="flex gap-2">
                    <button @click="showAddSurgeryModal = true" class="bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                        </svg>
                        æ–°å¢æ‰‹è¡“è¨˜éŒ„
                    </button>
                    <button @click="exportSurgeryCSV()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                        </svg>
                        åŒ¯å‡º CSV
                    </button>
                    <button @click="loadSurgeryRecords()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        é‡æ–°è¼‰å…¥
                    </button>
                </div>
            </div>

            <!-- æœå°‹ç¯©é¸ -->
            <div class="mb-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">é–‹å§‹æ—¥æœŸ</label>
                    <input type="date" x-model="surgerySearchForm.startDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">çµæŸæ—¥æœŸ</label>
                    <input type="date" x-model="surgerySearchForm.endDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ç—…æ‚£å§“å</label>
                    <input type="text" x-model="surgerySearchForm.patientName" placeholder="æœå°‹ç—…æ‚£..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 table-hover">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">è¨˜éŒ„ç·¨è™Ÿ</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ—¥æœŸ</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ç—…æ‚£å§“å</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ‰‹è¡“é¡å‹</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ä¸»åˆ€é†«å¸«</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ™‚é•·(åˆ†)</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <template x-for="record in surgeryRecords" :key="record.id">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900" x-text="record.record_number"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="record.record_date"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="record.patient_name"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="record.surgery_type"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="record.surgeon_name"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="record.duration_minutes || '-'"></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <button @click="viewSurgeryDetail(record)" class="text-blue-600 hover:text-blue-800">è©³æƒ…</button>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- æ–°å¢ç‰©å“ Modal -->
        <div x-show="showAddItemModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
            <div @click.away="showAddItemModal = false" class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    æ–°å¢ç‰©å“
                </h3>
                <form @submit.prevent="submitAddItem()" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç‰©å“ä»£ç¢¼ (ç•™ç©ºè‡ªå‹•ç”Ÿæˆ)</label>
                        <input type="text" x-model="addItemForm.code" placeholder="ç•™ç©ºå°‡è‡ªå‹•ç”Ÿæˆ" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç‰©å“åç¨± *</label>
                        <input type="text" x-model="addItemForm.name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">åˆ†é¡ *</label>
                        <select x-model="addItemForm.category" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                            <option value="æ‰‹è¡“è€—æ">æ‰‹è¡“è€—æ</option>
                            <option value="æ€¥æ•‘ç‰©è³‡">æ€¥æ•‘ç‰©è³‡</option>
                            <option value="è—¥å“">è—¥å“</option>
                            <option value="é˜²è­·ç”¨å“">é˜²è­·ç”¨å“</option>
                            <option value="é†«ç™‚è¨­å‚™">é†«ç™‚è¨­å‚™</option>
                            <option value="å…¶ä»–">å…¶ä»–</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å–®ä½</label>
                        <input type="text" x-model="addItemForm.unit" placeholder="EA" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æœ€å°åº«å­˜</label>
                        <input type="number" x-model="addItemForm.minStock" min="0" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div class="flex gap-4">
                        <button type="submit" class="flex-1 bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors">
                            ç¢ºèªæ–°å¢
                        </button>
                        <button type="button" @click="showAddItemModal = false" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                            å–æ¶ˆ
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ç·¨è¼¯ç‰©å“ Modal -->
        <div x-show="showEditItemModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
            <div @click.away="showEditItemModal = false" class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                    </svg>
                    ç·¨è¼¯ç‰©å“
                </h3>
                <form @submit.prevent="submitEditItem()" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç‰©å“ä»£ç¢¼</label>
                        <input type="text" x-model="editItemForm.code" disabled class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç‰©å“åç¨± *</label>
                        <input type="text" x-model="editItemForm.name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">åˆ†é¡ *</label>
                        <select x-model="editItemForm.category" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                            <option value="æ‰‹è¡“è€—æ">æ‰‹è¡“è€—æ</option>
                            <option value="æ€¥æ•‘ç‰©è³‡">æ€¥æ•‘ç‰©è³‡</option>
                            <option value="è—¥å“">è—¥å“</option>
                            <option value="é˜²è­·ç”¨å“">é˜²è­·ç”¨å“</option>
                            <option value="é†«ç™‚è¨­å‚™">é†«ç™‚è¨­å‚™</option>
                            <option value="å…¶ä»–">å…¶ä»–</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å–®ä½</label>
                        <input type="text" x-model="editItemForm.unit" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æœ€å°åº«å­˜</label>
                        <input type="number" x-model="editItemForm.minStock" min="0" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div class="flex gap-4">
                        <button type="submit" class="flex-1 bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors">
                            ç¢ºèªæ›´æ–°
                        </button>
                        <button type="button" @click="showEditItemModal = false" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                            å–æ¶ˆ
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- æ–°å¢è¨­å‚™ Modal -->
        <div x-show="showAddEquipmentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
            <div @click.away="showAddEquipmentModal = false" class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    æ–°å¢è¨­å‚™
                </h3>
                <form @submit.prevent="submitAddEquipment()" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">è¨­å‚™åç¨± *</label>
                        <input type="text" x-model="addEquipmentForm.name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">åˆ†é¡ *</label>
                        <select x-model="addEquipmentForm.category" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                            <option value="é›»åŠ›è¨­å‚™">é›»åŠ›è¨­å‚™</option>
                            <option value="ç©ºæ°£æ·¨åŒ–">ç©ºæ°£æ·¨åŒ–</option>
                            <option value="æ°´è™•ç†">æ°´è™•ç†</option>
                            <option value="å†·è—è¨­å‚™">å†·è—è¨­å‚™</option>
                            <option value="é€šè¨Šè¨­å‚™">é€šè¨Šè¨­å‚™</option>
                            <option value="ç…§æ˜è¨­å‚™">ç…§æ˜è¨­å‚™</option>
                            <option value="å…¶ä»–">å…¶ä»–</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡</label>
                        <input type="number" x-model="addEquipmentForm.quantity" min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å‚™è¨»</label>
                        <textarea x-model="addEquipmentForm.remarks" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500"></textarea>
                    </div>
                    <div class="flex gap-4">
                        <button type="submit" class="flex-1 bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors">
                            ç¢ºèªæ–°å¢
                        </button>
                        <button type="button" @click="showAddEquipmentModal = false" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                            å–æ¶ˆ
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ç·¨è¼¯è¨­å‚™ Modal -->
        <div x-show="showEditEquipmentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
            <div @click.away="showEditEquipmentModal = false" class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                    </svg>
                    ç·¨è¼¯è¨­å‚™
                </h3>
                <form @submit.prevent="submitEditEquipment()" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">è¨­å‚™ID</label>
                        <input type="text" x-model="editEquipmentForm.id" disabled class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">è¨­å‚™åç¨± *</label>
                        <input type="text" x-model="editEquipmentForm.name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">åˆ†é¡ *</label>
                        <select x-model="editEquipmentForm.category" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                            <option value="é›»åŠ›è¨­å‚™">é›»åŠ›è¨­å‚™</option>
                            <option value="ç©ºæ°£æ·¨åŒ–">ç©ºæ°£æ·¨åŒ–</option>
                            <option value="æ°´è™•ç†">æ°´è™•ç†</option>
                            <option value="å†·è—è¨­å‚™">å†·è—è¨­å‚™</option>
                            <option value="é€šè¨Šè¨­å‚™">é€šè¨Šè¨­å‚™</option>
                            <option value="ç…§æ˜è¨­å‚™">ç…§æ˜è¨­å‚™</option>
                            <option value="å…¶ä»–">å…¶ä»–</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡</label>
                        <input type="number" x-model="editEquipmentForm.quantity" min="0" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å‚™è¨»</label>
                        <textarea x-model="editEquipmentForm.remarks" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500"></textarea>
                    </div>
                    <div class="flex gap-4">
                        <button type="submit" class="flex-1 bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors">
                            ç¢ºèªæ›´æ–°
                        </button>
                        <button type="button" @click="showEditEquipmentModal = false" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                            å–æ¶ˆ
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- è¨­å‚™æª¢æŸ¥ Modal -->
        <div x-show="showCheckEquipmentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
            <div @click.away="showCheckEquipmentModal = false" class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                    </svg>
                    è¨­å‚™æª¢æŸ¥
                </h3>
                <form @submit.prevent="submitCheckEquipment()" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">è¨­å‚™åç¨±</label>
                        <input type="text" x-model="checkEquipmentForm.name" disabled class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç‹€æ…‹ *</label>
                        <select x-model="checkEquipmentForm.status" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                            <option value="NORMAL">æ­£å¸¸ (NORMAL)</option>
                            <option value="WARNING">è­¦å‘Š (WARNING)</option>
                            <option value="ERROR">ç•°å¸¸ (ERROR)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">é›»åŠ›ç­‰ç´š (0-100%)</label>
                        <input type="number" x-model="checkEquipmentForm.powerLevel" min="0" max="100" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å‚™è¨»</label>
                        <textarea x-model="checkEquipmentForm.remarks" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500"></textarea>
                    </div>
                    <div class="flex gap-4">
                        <button type="submit" class="flex-1 bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors">
                            ç¢ºèªæª¢æŸ¥
                        </button>
                        <button type="button" @click="showCheckEquipmentModal = false" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                            å–æ¶ˆ
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- æ–°å¢æ‰‹è¡“è¨˜éŒ„ Modal -->
        <div x-show="showAddSurgeryModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto" style="display: none;">
            <div @click.away="showAddSurgeryModal = false" class="bg-white rounded-xl shadow-2xl p-6 max-w-2xl w-full mx-4 my-8">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                    </svg>
                    æ–°å¢æ‰‹è¡“è¨˜éŒ„
                </h3>
                <form @submit.prevent="submitAddSurgery()" class="space-y-4">
                    <!-- åŸºæœ¬è³‡è¨Š -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ç—…æ‚£å§“å *</label>
                            <input type="text" x-model="addSurgeryForm.patientName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">æ‰‹è¡“é¡å‹ *</label>
                            <input type="text" x-model="addSurgeryForm.surgeryType" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ä¸»åˆ€é†«å¸« *</label>
                            <input type="text" x-model="addSurgeryForm.surgeonName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">éº»é†‰æ–¹å¼</label>
                            <input type="text" x-model="addSurgeryForm.anesthesiaType" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">æ‰‹è¡“æ™‚é•· (åˆ†é˜)</label>
                            <input type="number" x-model="addSurgeryForm.durationMinutes" min="0" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                        </div>
                    </div>

                    <!-- å‚™è¨» -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ‰‹è¡“å‚™è¨»</label>
                        <textarea x-model="addSurgeryForm.remarks" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500"></textarea>
                    </div>

                    <!-- è€—ææ¸…å–® -->
                    <div class="border-2 border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                </svg>
                                ä½¿ç”¨è€—æ
                            </h4>
                            <button type="button" @click="addConsumptionItem()" class="bg-blue-600 text-white px-3 py-1 rounded-lg hover:bg-blue-700 text-sm flex items-center gap-1">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                </svg>
                                æ–°å¢è€—æ
                            </button>
                        </div>

                        <div class="space-y-3">
                            <template x-for="(item, index) in addSurgeryForm.consumptions" :key="index">
                                <div class="flex gap-2 items-start border border-gray-200 rounded-lg p-3">
                                    <div class="flex-1 grid grid-cols-3 gap-2">
                                        <select x-model="item.itemCode" @change="updateConsumptionItemName(index)" required class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                                            <option value="">é¸æ“‡ç‰©å“</option>
                                            <template x-for="availableItem in items" :key="availableItem.code">
                                                <option :value="availableItem.code" x-text="`${availableItem.code} - ${availableItem.name}`"></option>
                                            </template>
                                        </select>
                                        <input type="number" x-model="item.quantity" required min="1" placeholder="æ•¸é‡" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
                                        <input type="text" x-model="item.unit" readonly placeholder="å–®ä½" class="px-3 py-2 border border-gray-300 rounded-lg bg-gray-50">
                                    </div>
                                    <button type="button" @click="removeConsumptionItem(index)" class="text-red-600 hover:text-red-800 p-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                        </svg>
                                    </button>
                                </div>
                            </template>
                        </div>

                        <div x-show="addSurgeryForm.consumptions.length === 0" class="text-center text-gray-400 py-4">
                            å°šæœªæ–°å¢è€—æ
                        </div>
                    </div>

                    <div class="flex gap-4 pt-4">
                        <button type="submit" class="flex-1 bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors">
                            ç¢ºèªå»ºç«‹
                        </button>
                        <button type="button" @click="showAddSurgeryModal = false; resetAddSurgeryForm()" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                            å–æ¶ˆ
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- æ‰‹è¡“è©³æƒ… Modal -->
        <div x-show="showSurgeryDetailModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto" style="display: none;">
            <div @click.away="showSurgeryDetailModal = false" class="bg-white rounded-xl shadow-2xl p-6 max-w-2xl w-full mx-4 my-8">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                    </svg>
                    æ‰‹è¡“è¨˜éŒ„è©³æƒ…
                </h3>
                
                <template x-if="selectedSurgery">
                    <div class="space-y-4">
                        <!-- åŸºæœ¬è³‡è¨Š -->
                        <div class="grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg">
                            <div>
                                <p class="text-sm text-gray-600">è¨˜éŒ„ç·¨è™Ÿ</p>
                                <p class="font-semibold" x-text="selectedSurgery.record_number"></p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">æ—¥æœŸ</p>
                                <p class="font-semibold" x-text="selectedSurgery.record_date"></p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">ç—…æ‚£å§“å</p>
                                <p class="font-semibold" x-text="selectedSurgery.patient_name"></p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">ç•¶æ—¥ç¬¬ N å°</p>
                                <p class="font-semibold" x-text="selectedSurgery.surgery_sequence"></p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">æ‰‹è¡“é¡å‹</p>
                                <p class="font-semibold" x-text="selectedSurgery.surgery_type"></p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">ä¸»åˆ€é†«å¸«</p>
                                <p class="font-semibold" x-text="selectedSurgery.surgeon_name"></p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">éº»é†‰æ–¹å¼</p>
                                <p class="font-semibold" x-text="selectedSurgery.anesthesia_type || '-'"></p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">æ‰‹è¡“æ™‚é•·</p>
                                <p class="font-semibold" x-text="selectedSurgery.duration_minutes ? selectedSurgery.duration_minutes + ' åˆ†é˜' : '-'"></p>
                            </div>
                        </div>

                        <!-- å‚™è¨» -->
                        <div x-show="selectedSurgery.remarks" class="bg-yellow-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-600 mb-1">å‚™è¨»</p>
                            <p class="text-gray-800" x-text="selectedSurgery.remarks"></p>
                        </div>

                        <!-- è€—ææ¸…å–® -->
                        <div class="border-2 border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold text-gray-700 mb-3 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                </svg>
                                ä½¿ç”¨è€—æ
                            </h4>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">ä»£ç¢¼</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">åç¨±</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">æ•¸é‡</th>
                                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">å–®ä½</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        <template x-for="consumption in selectedSurgery.consumptions" :key="consumption.item_code">
                                            <tr>
                                                <td class="px-4 py-2 text-sm font-mono" x-text="consumption.item_code"></td>
                                                <td class="px-4 py-2 text-sm" x-text="consumption.item_name"></td>
                                                <td class="px-4 py-2 text-sm font-semibold" x-text="consumption.quantity"></td>
                                                <td class="px-4 py-2 text-sm" x-text="consumption.unit"></td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="pt-4">
                            <button type="button" @click="showSurgeryDetailModal = false" class="w-full bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                                é—œé–‰
                            </button>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <!-- Toast é€šçŸ¥ -->
        <div x-show="showToast" x-transition class="fixed bottom-4 right-4 z-50" style="display: none;">
            <div :class="{
                'bg-green-500': toastType === 'success',
                'bg-red-500': toastType === 'error',
                'bg-blue-500': toastType === 'info'
            }" class="text-white px-6 py-3 rounded-lg shadow-lg">
                <p x-text="toastMessage"></p>
            </div>
        </div>

    </div>

    <script>
        function medicalInventory() {
            return {
                // åŸºæœ¬è¨­å®š
                apiUrl: 'http://localhost:8000/api',
                stationId: 'TC-01',
                currentTab: 'items',
                currentTime: '',
                
                // è³‡æ–™
                items: [],
                bloodInventory: [],
                equipment: [],
                surgeryRecords: [],
                stats: {
                    totalItems: 0,
                    lowStockItems: 0,
                    totalBlood: 0,
                    equipmentAlerts: 0
                },

                // Modal ç‹€æ…‹
                showAddItemModal: false,
                showEditItemModal: false,
                showAddEquipmentModal: false,
                showEditEquipmentModal: false,
                showCheckEquipmentModal: false,
                showAddSurgeryModal: false,
                showSurgeryDetailModal: false,

                // è¡¨å–®
                receiveForm: {
                    itemCode: '',
                    quantity: 1,
                    batchNumber: '',
                    expiryDate: '',
                    remarks: '',
                    stationId: 'TC-01'
                },
                consumeForm: {
                    itemCode: '',
                    quantity: 1,
                    purpose: '',
                    stationId: 'TC-01'
                },
                bloodReceiveForm: {
                    bloodType: '',
                    quantity: 1,
                    stationId: 'TC-01'
                },
                bloodConsumeForm: {
                    bloodType: '',
                    quantity: 1,
                    stationId: 'TC-01'
                },
                addItemForm: {
                    code: '',
                    name: '',
                    unit: 'EA',
                    minStock: 10,
                    category: 'å…¶ä»–'
                },
                editItemForm: {
                    code: '',
                    name: '',
                    unit: '',
                    minStock: 0,
                    category: ''
                },
                addEquipmentForm: {
                    name: '',
                    category: 'å…¶ä»–',
                    quantity: 1,
                    remarks: ''
                },
                editEquipmentForm: {
                    id: '',
                    name: '',
                    category: '',
                    quantity: 1,
                    remarks: ''
                },
                checkEquipmentForm: {
                    id: '',
                    name: '',
                    status: 'NORMAL',
                    powerLevel: null,
                    remarks: '',
                    stationId: 'TC-01'
                },
                addSurgeryForm: {
                    patientName: '',
                    surgeryType: '',
                    surgeonName: '',
                    anesthesiaType: '',
                    durationMinutes: null,
                    remarks: '',
                    consumptions: [],
                    stationId: 'TC-01'
                },
                surgerySearchForm: {
                    startDate: '',
                    endDate: '',
                    patientName: ''
                },
                selectedSurgery: null,

                // Toast
                showToast: false,
                toastMessage: '',
                toastType: 'info',

                // åˆå§‹åŒ–
                async init() {
                    this.updateTime();
                    setInterval(() => this.updateTime(), 1000);
                    
                    await this.loadStats();
                    await this.loadItems();
                    await this.loadBloodInventory();
                    await this.loadEquipment();
                    await this.loadSurgeryRecords();
                },

                updateTime() {
                    const now = new Date();
                    this.currentTime = now.toLocaleString('zh-TW', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: false
                    });
                },

                // åˆ†é åˆ‡æ›
                switchTab(tab) {
                    this.currentTab = tab;
                    if (tab === 'items') this.loadItems();
                    if (tab === 'blood') this.loadBloodInventory();
                    if (tab === 'equipment') this.loadEquipment();
                    if (tab === 'surgery') this.loadSurgeryRecords();
                },

                // è¼‰å…¥çµ±è¨ˆ
                async loadStats() {
                    try {
                        const response = await fetch(`${this.apiUrl}/stats`);
                        if (response.ok) {
                            this.stats = await response.json();
                        }
                    } catch (error) {
                        console.error('è¼‰å…¥çµ±è¨ˆå¤±æ•—:', error);
                    }
                },

                // è¼‰å…¥ç‰©å“
                async loadItems() {
                    try {
                        const response = await fetch(`${this.apiUrl}/items`);
                        if (response.ok) {
                            const data = await response.json();
                            this.items = data.items;
                        }
                    } catch (error) {
                        console.error('è¼‰å…¥ç‰©å“å¤±æ•—:', error);
                        this.toast('è¼‰å…¥ç‰©å“å¤±æ•—', 'error');
                    }
                },

                // æ–°å¢ç‰©å“
                async submitAddItem() {
                    try {
                        const response = await fetch(`${this.apiUrl}/items`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.addItemForm)
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'ç‰©å“æ–°å¢æˆåŠŸ', 'success');
                            this.showAddItemModal = false;
                            this.resetAddItemForm();
                            await this.loadItems();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'æ–°å¢å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('æ–°å¢ç‰©å“å¤±æ•—:', error);
                        this.toast('æ–°å¢ç‰©å“å¤±æ•—', 'error');
                    }
                },

                resetAddItemForm() {
                    this.addItemForm = {
                        code: '',
                        name: '',
                        unit: 'EA',
                        minStock: 10,
                        category: 'å…¶ä»–'
                    };
                },

                // ç·¨è¼¯ç‰©å“
                editItem(item) {
                    this.editItemForm = {
                        code: item.code,
                        name: item.name,
                        unit: item.unit,
                        minStock: item.min_stock,
                        category: item.category
                    };
                    this.showEditItemModal = true;
                },

                async submitEditItem() {
                    try {
                        const response = await fetch(`${this.apiUrl}/items/${this.editItemForm.code}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                name: this.editItemForm.name,
                                unit: this.editItemForm.unit,
                                minStock: this.editItemForm.minStock,
                                category: this.editItemForm.category
                            })
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'ç‰©å“æ›´æ–°æˆåŠŸ', 'success');
                            this.showEditItemModal = false;
                            await this.loadItems();
                        } else {
                            this.toast(data.detail || 'æ›´æ–°å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('æ›´æ–°ç‰©å“å¤±æ•—:', error);
                        this.toast('æ›´æ–°ç‰©å“å¤±æ•—', 'error');
                    }
                },

                // åˆªé™¤ç‰©å“
                async deleteItem(code, name) {
                    if (!confirm(`ç¢ºå®šè¦åˆªé™¤ç‰©å“ã€Œ${name}ã€å—?`)) return;
                    
                    try {
                        const response = await fetch(`${this.apiUrl}/items/${code}`, {
                            method: 'DELETE'
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'ç‰©å“å·²åˆªé™¤', 'success');
                            await this.loadItems();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'åˆªé™¤å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('åˆªé™¤ç‰©å“å¤±æ•—:', error);
                        this.toast('åˆªé™¤ç‰©å“å¤±æ•—', 'error');
                    }
                },

                // é€²è²¨
                async submitReceive() {
                    try {
                        const response = await fetch(`${this.apiUrl}/receive`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.receiveForm)
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'é€²è²¨è¨˜éŒ„æˆåŠŸ', 'success');
                            this.resetReceiveForm();
                            await this.loadItems();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'é€²è²¨å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('é€²è²¨å¤±æ•—:', error);
                        this.toast('é€²è²¨å¤±æ•—', 'error');
                    }
                },

                resetReceiveForm() {
                    this.receiveForm = {
                        itemCode: '',
                        quantity: 1,
                        batchNumber: '',
                        expiryDate: '',
                        remarks: '',
                        stationId: this.stationId
                    };
                },

                // æ¶ˆè€—
                async submitConsume() {
                    try {
                        const response = await fetch(`${this.apiUrl}/consume`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.consumeForm)
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'æ¶ˆè€—è¨˜éŒ„æˆåŠŸ', 'success');
                            this.resetConsumeForm();
                            await this.loadItems();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'æ¶ˆè€—å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('æ¶ˆè€—å¤±æ•—:', error);
                        this.toast('æ¶ˆè€—å¤±æ•—', 'error');
                    }
                },

                resetConsumeForm() {
                    this.consumeForm = {
                        itemCode: '',
                        quantity: 1,
                        purpose: '',
                        stationId: this.stationId
                    };
                },

                // è¡€è¢‹
                async loadBloodInventory() {
                    try {
                        const response = await fetch(`${this.apiUrl}/blood/inventory`);
                        if (response.ok) {
                            const data = await response.json();
                            this.bloodInventory = data.bloodInventory;
                        }
                    } catch (error) {
                        console.error('è¼‰å…¥è¡€è¢‹åº«å­˜å¤±æ•—:', error);
                    }
                },

                async submitBloodReceive() {
                    try {
                        const response = await fetch(`${this.apiUrl}/blood/receive`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.bloodReceiveForm)
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'è¡€è¢‹å…¥åº«æˆåŠŸ', 'success');
                            this.bloodReceiveForm = { bloodType: '', quantity: 1, stationId: this.stationId };
                            await this.loadBloodInventory();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'å…¥åº«å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('è¡€è¢‹å…¥åº«å¤±æ•—:', error);
                        this.toast('è¡€è¢‹å…¥åº«å¤±æ•—', 'error');
                    }
                },

                async submitBloodConsume() {
                    try {
                        const response = await fetch(`${this.apiUrl}/blood/consume`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.bloodConsumeForm)
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'è¡€è¢‹å‡ºåº«æˆåŠŸ', 'success');
                            this.bloodConsumeForm = { bloodType: '', quantity: 1, stationId: this.stationId };
                            await this.loadBloodInventory();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'å‡ºåº«å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('è¡€è¢‹å‡ºåº«å¤±æ•—:', error);
                        this.toast('è¡€è¢‹å‡ºåº«å¤±æ•—', 'error');
                    }
                },

                // è¨­å‚™ç®¡ç†
                async loadEquipment() {
                    try {
                        const response = await fetch(`${this.apiUrl}/equipment`);
                        if (response.ok) {
                            const data = await response.json();
                            this.equipment = data.equipment;
                        }
                    } catch (error) {
                        console.error('è¼‰å…¥è¨­å‚™å¤±æ•—:', error);
                        this.toast('è¼‰å…¥è¨­å‚™å¤±æ•—', 'error');
                    }
                },

                async submitAddEquipment() {
                    try {
                        const response = await fetch(`${this.apiUrl}/equipment`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.addEquipmentForm)
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'è¨­å‚™æ–°å¢æˆåŠŸ', 'success');
                            this.showAddEquipmentModal = false;
                            this.resetAddEquipmentForm();
                            await this.loadEquipment();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'æ–°å¢å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('æ–°å¢è¨­å‚™å¤±æ•—:', error);
                        this.toast('æ–°å¢è¨­å‚™å¤±æ•—', 'error');
                    }
                },

                resetAddEquipmentForm() {
                    this.addEquipmentForm = {
                        name: '',
                        category: 'å…¶ä»–',
                        quantity: 1,
                        remarks: ''
                    };
                },

                editEquipment(eq) {
                    this.editEquipmentForm = {
                        id: eq.id,
                        name: eq.name,
                        category: eq.category,
                        quantity: eq.quantity,
                        remarks: eq.remarks || ''
                    };
                    this.showEditEquipmentModal = true;
                },

                async submitEditEquipment() {
                    try {
                        const response = await fetch(`${this.apiUrl}/equipment/${this.editEquipmentForm.id}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                name: this.editEquipmentForm.name,
                                category: this.editEquipmentForm.category,
                                quantity: this.editEquipmentForm.quantity,
                                remarks: this.editEquipmentForm.remarks
                            })
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'è¨­å‚™æ›´æ–°æˆåŠŸ', 'success');
                            this.showEditEquipmentModal = false;
                            await this.loadEquipment();
                        } else {
                            this.toast(data.detail || 'æ›´æ–°å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('æ›´æ–°è¨­å‚™å¤±æ•—:', error);
                        this.toast('æ›´æ–°è¨­å‚™å¤±æ•—', 'error');
                    }
                },

                async deleteEquipment(id, name) {
                    if (!confirm(`ç¢ºå®šè¦åˆªé™¤è¨­å‚™ã€Œ${name}ã€å—?`)) return;
                    
                    try {
                        const response = await fetch(`${this.apiUrl}/equipment/${id}`, {
                            method: 'DELETE'
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'è¨­å‚™å·²åˆªé™¤', 'success');
                            await this.loadEquipment();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'åˆªé™¤å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('åˆªé™¤è¨­å‚™å¤±æ•—:', error);
                        this.toast('åˆªé™¤è¨­å‚™å¤±æ•—', 'error');
                    }
                },

                checkEquipment(eq) {
                    this.checkEquipmentForm = {
                        id: eq.id,
                        name: eq.name,
                        status: 'NORMAL',
                        powerLevel: eq.power_level,
                        remarks: '',
                        stationId: this.stationId
                    };
                    this.showCheckEquipmentModal = true;
                },

                async submitCheckEquipment() {
                    try {
                        const response = await fetch(`${this.apiUrl}/equipment/check/${this.checkEquipmentForm.id}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                stationId: this.checkEquipmentForm.stationId,
                                status: this.checkEquipmentForm.status,
                                powerLevel: this.checkEquipmentForm.powerLevel,
                                remarks: this.checkEquipmentForm.remarks
                            })
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'è¨­å‚™æª¢æŸ¥å®Œæˆ', 'success');
                            this.showCheckEquipmentModal = false;
                            await this.loadEquipment();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'æª¢æŸ¥å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('è¨­å‚™æª¢æŸ¥å¤±æ•—:', error);
                        this.toast('è¨­å‚™æª¢æŸ¥å¤±æ•—', 'error');
                    }
                },

                // æ‰‹è¡“è¨˜éŒ„
                async loadSurgeryRecords() {
                    try {
                        let url = `${this.apiUrl}/surgery/records?limit=50`;
                        
                        if (this.surgerySearchForm.startDate) {
                            url += `&start_date=${this.surgerySearchForm.startDate}`;
                        }
                        if (this.surgerySearchForm.endDate) {
                            url += `&end_date=${this.surgerySearchForm.endDate}`;
                        }
                        if (this.surgerySearchForm.patientName) {
                            url += `&patient_name=${encodeURIComponent(this.surgerySearchForm.patientName)}`;
                        }
                        
                        const response = await fetch(url);
                        if (response.ok) {
                            const data = await response.json();
                            this.surgeryRecords = data.records;
                        }
                    } catch (error) {
                        console.error('è¼‰å…¥æ‰‹è¡“è¨˜éŒ„å¤±æ•—:', error);
                        this.toast('è¼‰å…¥æ‰‹è¡“è¨˜éŒ„å¤±æ•—', 'error');
                    }
                },

                addConsumptionItem() {
                    this.addSurgeryForm.consumptions.push({
                        itemCode: '',
                        itemName: '',
                        quantity: 1,
                        unit: ''
                    });
                },

                removeConsumptionItem(index) {
                    this.addSurgeryForm.consumptions.splice(index, 1);
                },

                updateConsumptionItemName(index) {
                    const itemCode = this.addSurgeryForm.consumptions[index].itemCode;
                    const item = this.items.find(i => i.code === itemCode);
                    if (item) {
                        this.addSurgeryForm.consumptions[index].itemName = item.name;
                        this.addSurgeryForm.consumptions[index].unit = item.unit;
                    }
                },

                async submitAddSurgery() {
                    if (this.addSurgeryForm.consumptions.length === 0) {
                        this.toast('è«‹è‡³å°‘æ–°å¢ä¸€é …è€—æ', 'error');
                        return;
                    }

                    try {
                        const response = await fetch(`${this.apiUrl}/surgery/record`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.addSurgeryForm)
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.toast(data.message || 'æ‰‹è¡“è¨˜éŒ„å»ºç«‹æˆåŠŸ', 'success');
                            this.showAddSurgeryModal = false;
                            this.resetAddSurgeryForm();
                            await this.loadSurgeryRecords();
                            await this.loadItems();
                            await this.loadStats();
                        } else {
                            this.toast(data.detail || 'å»ºç«‹å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        console.error('å»ºç«‹æ‰‹è¡“è¨˜éŒ„å¤±æ•—:', error);
                        this.toast('å»ºç«‹æ‰‹è¡“è¨˜éŒ„å¤±æ•—', 'error');
                    }
                },

                resetAddSurgeryForm() {
                    this.addSurgeryForm = {
                        patientName: '',
                        surgeryType: '',
                        surgeonName: '',
                        anesthesiaType: '',
                        durationMinutes: null,
                        remarks: '',
                        consumptions: [],
                        stationId: this.stationId
                    };
                },

                viewSurgeryDetail(record) {
                    this.selectedSurgery = record;
                    this.showSurgeryDetailModal = true;
                },

                async exportSurgeryCSV() {
                    try {
                        let url = `${this.apiUrl}/surgery/export/csv`;
                        const params = [];
                        
                        if (this.surgerySearchForm.startDate) {
                            params.push(`start_date=${this.surgerySearchForm.startDate}`);
                        }
                        if (this.surgerySearchForm.endDate) {
                            params.push(`end_date=${this.surgerySearchForm.endDate}`);
                        }
                        
                        if (params.length > 0) {
                            url += '?' + params.join('&');
                        }
                        
                        window.open(url, '_blank');
                        this.toast('CSV åŒ¯å‡ºæˆåŠŸ', 'success');
                    } catch (error) {
                        console.error('åŒ¯å‡º CSV å¤±æ•—:', error);
                        this.toast('åŒ¯å‡º CSV å¤±æ•—', 'error');
                    }
                },

                // Toast é€šçŸ¥
                toast(message, type = 'info') {
                    this.toastMessage = message;
                    this.toastType = type;
                    this.showToast = true;
                    setTimeout(() => {
                        this.showToast = false;
                    }, 3000);
                }
            };
        }
    </script>
</body>
</html>
